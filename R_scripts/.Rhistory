library("DESeq2")
library(biomaRt)
# loading in featureCounts data -------------------------------------------
# load counts.txt as a data frame
counts_file <- read.table("counts.txt", header=TRUE, comment.char="#", check.names=FALSE)
# create df of raw counts, no annotation info
raw_counts_df <- counts_file[7:ncol(counts_file)]
# replace shitty full path colnames using pre-made samplenames.txt
samplenames <- read.delim('samplenames.txt')
colnames(raw_counts_df) <- samplenames$Sample
# set row names = the gene ID
rownames(raw_counts_df) <- counts_file$Geneid
# create colData ----------------------------------------------------------
# trim the name to isolate the type (WT or KO) and condition (case or control)
type_trim <- sub("_.*", "", sub("Blood_", "", samplenames$Group))
condition_trim <- sub(".*_", "", samplenames$Group)
# construct coldata df, strings as factors
coldata <- data.frame(
sample = samplenames$Sample,
type = type_trim,
condition = condition_trim,
stringsAsFactors = TRUE
)
View(coldata)
